---
title: "Taylor Swift Song Analysis: What Makes An Album Good Or Bad, Based On The Features Of Their Songs?"
author: "Arvind Ramakrishnan (A0253523L), Jason Matthew Suhari (A0286652U), Jason Ray, Tay Jia Jun Jeremy (A0277620A)"
date: "`r Sys.Date()`"
output: html_document
---

## Introduction

### Background

This project analyzes Taylor Swift's albums that were released up until 2023, with the latest being *1989 (Taylor's Version)*. 

The [dataset](https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-10-17/readme.md) is sourced from [TidyTuesday](https://github.com/rfordatascience/tidytuesday), featuring the following key variables:

1. **`album_name`**: Name of the album that a specific song belongs to

2. **`danceability`**: A metric of how suitable a song is for dancing (0 - 1)

3. **`energy`**: A metric of how intense and energetic a song is (0 - 1)

4. **`loudness`**: Measure of loudness in decibels (dB)

5. **`speechiness`**: A metric of how many words are spoken in a song (0 - 1)

6. **`acousticness`**: A metric of whether or not a song is acoustic, meaning void of electric amplification (0 - 1)

7. **`valence`**: A metric of how musically positive (i.e., happy, cheerful) a song is (0 - 1)

8. **`tempo`**: The overall estimated tempo of the track, measured in BPM

9. **`album_release`**: The release date of the album, meaning some songs will have the same value for this column

10. **`metacritic_score`**: A score out of 100 that represents the average critical rating for the entire album, meaning some songs will have the same value for this column

11. **`user_score`**: A score out of 100 that represents the average user rating for the entire album, meaning some songs will have the same value for this column


### Main Question

**What are the key differences, in terms of musical features, between the songs of a highly rated album and relatively lower rated album of Taylor Swift?**

### Sub-Questions
1.) The good and bad albums of Taylor Swift based on metacritic score and user score. 

2.) The song features breakdown for Talyor Swift Top 2 and Bottom 2 Album.

3.) The distribution of valence in albums from the Top 2 Albums (based on metacritic and user scores) and a specific album (in this case, Taylor Swift).

## Data Parsing and Initialization

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE, include = TRUE,
                      fig.align = "center",  out.width = "80%")
```

### Library Imports
```{r}
library(ggplot2)
library(dplyr)
library(taylor)
library(tidyverse)
library(viridis)
library(lubridate)
```

### Data Ingestion & Cleaning
The main Taylor Swift datasets that we will be using in our data analysis are the `taylor_albums` and `taylor_album_songs` datasets. We will be omitting the `taylor_all_songs` dataset from the scope of our project since the key variables that we intend to use for our visualizations and analysis are contained in the `taylor_album_songs` and these variables are also repeated in the `taylor_all_songs` dataset and therefore is redundant to the primary objective of our data analysis. **Section 1** which entails **Visualization 1** will only utilize the `taylor_albums` dataset, whereas the `taylor_album_songs` left joined with the `taylor_albums` dataset will be used for anaylsis in **Section 2** and **Section 3** and their visualizations respectively.

The first part is the transformation and cleaning of `taylor_albums` dataset which will be used in **Section 1** and as a part of the data transformation and cleaning we first remove the rows with missing values. Then we remove the albums "Fearless" and "Red" from this data and the analysis in **Section 1** due to the fact that these albums are not present in the `taylor_album_songs` dataset, which will be used in for visualizations and analysis in subsequent sections. Subsequently, we will scale the user scores to be weighted out of 100 by multiplying the `user_score` variable by 10 (as it is originally weighted on a scale of 1-10)
Finally, we will use the `pivot_longer` function to tidy the `df_plot1` dataframe into a longer format, since in the original `taylor_albums` dataset, the column headers of the variables `metacritic_score` and `user_score` are actually values that we would like to use in this bar plot visualization to distinctly illustrate the metacritic and user scores separately. We create the new variables `score_type` and `score` to store the type (metacritic or user) of score and the value of the score (weighted out of 100) respectively

```{r}
# create a dataframe df_plot1 to use for the visualization and analysis in this section
df_plot1 <- drop_na(taylor_albums)
# remove the albums "Fearless" and "Red"
df_plot1 <- df_plot1 %>% filter(!((album_name == "Fearless")|(album_name == "Red")))
# scale the user scores to be weighted out of 100
df_plot1$user_score <- df_plot1$user_score * 10
# tidy the data
df_plot1 <- df_plot1 %>% pivot_longer(`metacritic_score`:`user_score`, names_to = "score_type", values_to = "score")
df_plot1
```


In this part, we first transform and clean the `taylor_album_songs` dataset by first selecting and keeping only the `album_name`, `danceability`, `energy`, `loudness`, `speechiness`, `acousticness`, `valence` and `tempo` variables and drop the rest as there are the variables of interest that will be used for the analysis in **Section 2** and **Section 3**. Secondly, we remove all the rows with missing values and finally we join the two datasets together using a left join so that each song in the `taylor_album_songs` dataset can be associated/linked to its respective album names from `taylor_albums`, which faciliates a meaningful analysis. We store this transformed and cleaned version of the `taylor_album_songs` dataset joined with the `taylor_albums` dataset in a dataframe object called `df` which is the main data object that will be used in **Section 2** and **Section 3**.

```{r}
data <- tidytuesdayR::tt_load('2023-10-17')
cols_to_select <- c("album_name", "danceability", "energy", "loudness", "speechiness", "acousticness", "valence", "tempo")

taylor_albums <- data$taylor_albums

df <- data$taylor_album_songs %>% 
  select(all_of(cols_to_select)) %>% 
  drop_na() %>% 
  left_join(taylor_albums, by = "album_name") %>% 
  select(-c("ep"))
```

### Exploratory Data Analysis
This portion comprises the exploratory data analysis that computes key summary statistics to ascertain the key characteristics and features of the dataset stored in `df`. 
```{r, results = "hide"}
glimpse(df)

# looking at distribution of all data
dist <- df %>% 
  select(where(is.numeric)) %>% 
  pivot_longer(cols = everything(), names_to = "var", values_to = "val") %>%
  ggplot(aes(x = val)) +
  geom_histogram(bins = 30) +
  labs(title = "Distribution of All Numeric Variables") +
  theme_bw() +
  facet_wrap(~var, scales = "free") +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()
    )

# finding outliers
outliers <- df %>%
  select(where(is.numeric)) %>%
  pivot_longer(cols = everything(), names_to = "var", values_to = "val") %>%
  ggplot(aes(x = var, y = val)) +
  geom_boxplot() +
  labs(title = "Boxplot for Potential Outliers in Taylor Swift's Songs") +
  theme_bw() +
  facet_wrap(~var, scales = "free") +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()
    )

heatmap <- df %>%
  select(where(is.numeric)) %>%
  cor() %>%
  as.data.frame() %>% 
  rownames_to_column(var = "x") %>%
  pivot_longer(cols = -x, names_to = "y", values_to = "value") %>%
  ggplot(aes(x = x, y = y, fill = value)) +
  geom_tile(color = "black") +
  labs(title = "Correlation Heatmap of Numerical Variables", x = "", y = "")
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 90, vjust = 1, hjust = 1),
    plot.title = element_text(hjust = 0.5)
  ) 
```

## Section 1

### Visualization 1
*Bar chart that plots the values of metacritic score and user score of each taylor swift album*

**Part 1: Bar Plot**
Using the fully transformed and cleaned version of the `taylor_albums` dataset which is now stored in the dataframe `df_plot1`, we now plot the bar chart using the `geom_col` function. For this visualization we use the variables `album_names`, `score` and `score_type`. The rationale behind choosing a bar plot for this visualization is that it allows our readers to not only view the metacritic and user scores of each albums more vividly, but it also enables them to compare these scores side by side in an easier and comprehensible manner due to the presence of distinct bars for both the metacritic and user score of each album respectively.This will facilitate the readers to ascertain which albums will be used in the subsequent sections. 
```{r}
ggplot(df_plot1, aes(album_name, y = score, fill = score_type)) +
  geom_col(position = "dodge") +
  labs(title = "Metacritic and User Score of Taylor Swift Albums",
       x = "Album Names",
       y = "Score (weighted out of 100)" ) +
  scale_fill_viridis(option = "viridis", discrete = TRUE) +
  theme(axis.text.x = element_text(angle = 90)) +
  geom_text(aes(x = album_name, y = score, label = score), 
            position = position_dodge(width = 0.9),
            vjust = -0.25)
```

**Part 2: Insights from Visualization 1**
From the plot above, it is possible to infer that "Red (Taylor's Version)" and "folklore" have the two highest ratings, with an user score of 90 each and they also have the highest combined user + metacritic score with a combined total of 180 and 178 respectively. Therefore "Red (Taylor's Version)" and "folklore" are the 2 albums that we select for the 2 highest rated albums for subsequent analysis in the next section. Similarly, from the plot above it  can be inferred that "reputation" and "Taylor Swift" have the two lowest ratings, with an user score of 83 and 85 and they also have the lowest combined user + metacritic score with a combined total of 154 and 152 respectively. Therefore "Taylor Swift" and "reputation" are the 2 albums that we select for the 2 lowest rated albums for subsequent analysis in the next section.

As for the summary of the overall patterns from this analysis and visualization, it can be inferred and concluded that the difference between the heights of the yellow bars are minimal which is indicative of the fact that almost all of Taylor Swift's albums are rated highly by the users with the lowest user score being 82 and the highest user score being 90. Whereas the purple bars which represent the metacritic scores are appear generally the same but there are some noticeable differences in their size due to the fact that some albums have received a metacritic score below 80 which are relatively low in comparision to the higher rated albums. For example the highest metacritic score is 91 whereas the lowest metacritic score is 67 which signals a significant discrepany from the user scores which are vastly identical.

## Section 2

### Visualization 2
*Scatter chart that plots the numerical values of the features of each song in 4 different Taylor Swift albums- the 2 highest rated albums and the 2 lowest rated albums*

**Part 1: Scatter Plot**
Using the fully transformed and cleaned version of the `taylor_album_songs` dataset joined with `taylor_albums` dataset which is now stored in the dataframe `df`, we now plot the scatter chart using the `geom_point` function. For this visualization we use the variables `acousticness`, `danceability`, `energy`, `liveness`, `loudness`, `speechiness`, `tempo` and `valence` and compare these song features across the 4 chosen albums. To ease the illustration of these features, we first create use the `pivot_longer` function to convert the names of the aforementioned features into values and store them in a variable named `features` and the actual numerical values of these features are stored in a new variable named `score`. This is stored in a new dataframe called `df_plot2` and ultimately the variables that we will use directly for this visualization are `album_name`, `score` and `features`. The primary rationale behind using a scatter plot for this visualization is that it allows us to individually visualize the numeric values of the song features for each song, for all the 8 chosen features (each point in the plot is a song). As opposed to other types of plots/graphs, where we would have to average out the numerical values of all these features across all the songs in an album and plot only the average values of these features in each album, using the `geom_point` scatter plot visualization enables us to represent each song and their values of the 8 features as a separate point. This facilitates a more meaningful and insightful analysis and better answers the main question of interest since this plot illustrates the features of each and every song from the best 2 and worst 2 albums.
```{r}
taylor_albums %>% arrange(desc(metacritic_score),desc(user_score))

top_two_album = c("Red (Taylor's Version)", "folklore")
btm_two_album = c("reputation", "Taylor Swift")

df_plot2 <- df %>% select(album_name:tempo, user_score) %>% 
  filter(album_name %in% top_two_album | album_name %in% btm_two_album) %>%
  pivot_longer(cols= danceability:tempo, names_to = "features", values_to = "score") %>% 
  mutate(features = str_to_title(features), album_name = str_to_title(album_name))

ggplot(df_plot2, aes(x = album_name, y = score, color = album_name)) +
  geom_point(size = 2, alpha = 0.5) + 
  scale_fill_viridis(option = "viridis", discrete = TRUE) +
  facet_wrap(~ features, scales = "free") + 
  theme(axis.text.x = element_blank()) +
  labs(title = "Characteristics of Taylor's Top and Bottom 2 Albums Based on User Scores", x = "", y = "Score", color = "Album")


```

**Part 2: Insights from Visualization 2**
It can be seen that the four albums sometimes display noticeable features in the variables that sets it apart from the others, while other times there does not seem to be a clear difference between them. For example, Taylor's Swift's best album, "folklore", has considerably higher acousticness in general compared to the others. We can also notice that the 2 worst albums is generaly louder and has more energy than the 2 best albums. However, there does not seem to be any noticeable difference in tempo distribution among the songs in each of the four albums.

As for the summary of the overall patterns from this analysis and visualization, this scatter chart shows that while some variables has a visible correlation to whether an album is perceived as good or bad, there are also other variables that might not have any effect on them.


## Section 3

### Visualization 3: 
*Density plot that visualizes the distribution of valence in albums from the Top 2 Albums (based on metacritic and user scores) and a specific album (in this case, Taylor Swift)*

**Part 1: Density Plot**

```{r}
top_2_albums <- c("Red (Taylor's Version)", "folklore")

best_album_data <- df %>%
  filter(album_name %in% top_2_albums) %>%
  mutate(label = "Top 2 Albums")

other_album_data <- df %>%
  filter(!(album_name %in% top_2_albums)) %>%
  mutate(label = "All Other Albums")

data_to_plot <- bind_rows(best_album_data, other_album_data)

ggplot(data_to_plot, 
       aes(x = valence, fill = label, color = label)) +
  geom_density(alpha = 0.5) +
  labs(title = paste("Valence Distribution of Top 2 Albums VS Other Albums"),
       x = "Valence",
       y = "Density (Across Album)") +
  theme_bw() +
  theme(
    plot.title = element_text(hjust = 0.5),
    legend.position = "bottom"
    ) +
  scale_fill_viridis_d(option = "viridis") +
  scale_color_viridis_d(option = "viridis")
```

**Part 2: Insights from Visualization 3**
This graph shows the distribution of `valence` across the top two best albums (yellow) and the other albums (purple). The density curves reveal that the best albums, decided by a combination of Metacritic and user score, tend to have a higher density of mid to high valence songs, indicating slightly more positive tones. Meanwhile, the aggregate of all other albums show a spread of low to mid valence. This suggests that despite Taylor Swift's reputation of only singing about her exes or her breakups, her positive-sounding albums are better received by fans and critics alike.

In summary, this graph shows the distribution of `valence`, revealing that the best albums have a higher valence / scale of positivity compared to her other albums. While some other factors may come into play when it comes to one of her fans or a critic deciding whether or not her song is good, it seems that the general public are better able to connect themselves to the album through positive songs. 


## Summary
Through these visualizations, we have modeled comparisons between Taylor Swift's albums, with focus on the features of the 2 highest-rated and 2 lowest-rated albums. It can be summarized that while these albums may have little to no differences in several features, some features, notably valence, seem to be positively correlated to the relative goodness of an album. This shows that while Taylor Swift's songs might generally be similar to each other, a key feature that sets it apart can have a relatively noticeable impact to how the album is perceived by users and critics alike.
